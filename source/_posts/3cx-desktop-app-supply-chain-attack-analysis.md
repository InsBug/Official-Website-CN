---
title: 3CX Desktop Appä¾›åº”é“¾æ”»å‡»åˆ†æ
slug: 3cx-desktop-app-supply-chain-attack-analysis
date: 2023-05-12 18:00:00
author: å¼ æ ©æ»”
categories:
  - äº‹ä»¶åˆ†æ
tags:
  - 3CX
  - ä¾›åº”é“¾å®‰å…¨
  - æ¡Œé¢åº”ç”¨
  - æ¼æ´åˆ†æ
  - äºŒè¿›åˆ¶å®‰å…¨
---

## ä¸€ã€äº‹ä»¶èƒŒæ™¯

3CXæ˜¯ä¸€å®¶è½¯ä»¶å…¬å¸ï¼Œè¯¥å…¬å¸ä¸ºå®¢æˆ·æä¾›åŸºäºè½¯ä»¶çš„ç”µè¯ç³»ç»Ÿï¼Œç”¨äºä¼ä¸šæˆ–ç»„ç»‡å†…éƒ¨çš„é€šè®¯ã€‚

3CXç”µè¯ç³»ç»Ÿå¯ä»¥åœ¨Windowsæˆ–LinuxæœåŠ¡å™¨ä¸Šéƒ¨ç½²ï¼Œå¹¶æä¾›åŒ…æ‹¬VoIPã€PSTNå’Œç§»åŠ¨ç”µè¯åœ¨å†…çš„å¤šç§é€šè®¯æ–¹å¼ã€‚æ­¤å¤–ï¼Œ3CXè¿˜æä¾›ä¸€ç³»åˆ—çš„é€šè®¯è½¯ä»¶ï¼ŒåŒ…æ‹¬ç”¨äºç”µè„‘ã€ç§»åŠ¨è®¾å¤‡åŠæµè§ˆå™¨çš„åº”ç”¨ç¨‹åºï¼Œå¯ä»¥è®©ç”¨æˆ·é€šè¿‡å„ç§æ–¹å¼ä¸ä»–äººé€šè®¯ã€‚æ®3CXç§°ï¼Œå…¶æä¾›çš„è½¯ä»¶æœåŠ¡äº†600,000å¤šä¸ªå®¢æˆ·ï¼Œéå¸ƒå…¨çƒ190å¤šä¸ªå›½å®¶ã€‚

2023å¹´3æœˆ29æ—¥ï¼ŒCrowdStrikeå‘å‡ºå‘Šè­¦ï¼ŒæŒ‡å‡ºå…·å¤‡åˆæ³•ç­¾åçš„äºŒè¿›åˆ¶ç¨‹åº3CXDesktopAppå­˜åœ¨æ¶æ„è¡Œä¸ºã€‚

## äºŒã€äº‹ä»¶è¿‡ç¨‹

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398267230.7019968828792732.jpeg)

### 2023å¹´3æœˆ22æ—¥

å‡Œæ™¨ä¸€ç‚¹ï¼Œéƒ¨åˆ†ç”¨æˆ·åé¦ˆ3CXDesktopAppè‡ªåŠ¨æ›´æ–°çš„ç‰ˆæœ¬è¢«æ€æ¯’è½¯ä»¶å‘Šè­¦ã€‚æ­¤æ—¶éƒ¨åˆ†ç”¨æˆ·è¿˜å°†å…¶å®šæ€§ä¸ºè¯¯æŠ¥ã€‚

SentinelOneçš„å‘Šè­¦ä¿¡æ¯æ˜¾ç¤ºè½¯ä»¶å­˜åœ¨shellcodeæˆ–ä»£ç æ”»å‡»èƒ½åŠ›ã€‚

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398267960.5119399897774438.png)

### 2023å¹´3æœˆ29æ—¥

ä¸Šåˆåä¸€ç‚¹ï¼Œå®‰å…¨å…¬å¸CrowdStrikeå‘å‡ºå‘Šè­¦ï¼Œç¡®å®šå…·å¤‡åˆæ³•ç­¾åçš„äºŒè¿›åˆ¶ç¨‹åº3CXDesktopAppå­˜åœ¨æ¶æ„è¡Œä¸ºï¼Œå±å®³Windowså’ŒmacOSã€‚

CrowdStrikeæ€€ç–‘å…¶æ”»å‡»è¡Œä¸ºæºäºLABYRINTH CHOLLIMAï¼Œè¿™æ˜¯ä¸€ä¸ªå…·æœ‰æœ‰æœé²œç›¸å…³èƒŒæ™¯çš„ä¸“ä¸šAPTç»„ç»‡ã€‚

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398268700.33788745420994937.png)

### 2023å¹´3æœˆ30æ—¥

ä¸Šåˆå…­ç‚¹ï¼Œ3CXçš„CEO Nike Galeaå‘å‡ºå®‰å…¨è­¦å‘Šï¼Œç¡®è®¤3CXçš„Windows Electron clienté­å—æ”»å‡»ï¼Œå¹¶å»ºè®®ç”¨æˆ·å¸è½½è¯¥åº”ç”¨ç¨‹åºæ”¹è€Œé€‰æ‹©åŸºäºWEBçš„PWAå®¢æˆ·ç«¯ã€‚

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398269500.2845779199483798.png)

### 2023å¹´4æœˆ6æ—¥

3CXå‘å¸ƒæœªè¢«æ”»å‡»çš„18.12.425ç‰ˆæœ¬è½¯ä»¶ï¼Œä½†ä»ç„¶å»ºè®®ç”¨æˆ·ä½¿ç”¨åŸºäºWEBçš„PWAå®¢æˆ·ç«¯ã€‚

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398270290.2874150682215777.png)

## ä¸‰ã€æŠ€æœ¯åˆ†æ

### å—å½±å“ç‰ˆæœ¬

ğŸ‘‰Windows versions 18.12.407 and 18.12.416

ğŸ‘‰Mac OS versions 18.11.1213, 18.12.402, 18.12.407, and 18.12.416.

éƒ¨åˆ†æ–‡ä»¶åŠå¯¹åº”hashå¦‚ä¸‹ï¼š

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398271020.33438555376116263.png)

### æ”»å‡»åˆ†æ

å®‰è£…ç¨‹åºå…·æœ‰åˆæ³•ç­¾åï¼Œå®‰è£…åçš„3CXDesktopAppå¯åŠ¨æ—¶ä¼šä¸»åŠ¨åŠ è½½å®‰è£…ç›®å½•ä¸‹æ²¡æœ‰ç­¾åçš„ffmpeg.dllã€‚

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398271710.7730798543903151.png)

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398272460.7442970494608779.png)

ffmpeg.dllè¢«åŠ è½½çš„æ—¶å€™ä¼šè¿›è¡Œä»¥ä¸‹è¡Œä¸ºï¼š

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398273210.18285612281279984.png)

é¦–å…ˆæ‰“å¼€å®‰è£…è·¯å¾„ä¸‹çš„d3dcompiler\_47.dllæ–‡ä»¶ï¼Œå¹¶è¯»å…¥å†…å­˜ã€‚

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398273910.27361617530929605.png)

å¯¹æ¯”è¯»å…¥å†…å­˜æ•°æ®ä¸ç£ç›˜æ•°æ®å‘ç°ä¸€è‡´ï¼Œä¸”è¯»å…¥æ•°æ®å¤§å°ä¸º0x4EDCD8ã€‚

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398274670.8370407514965168.png)

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398275420.13149222075805966.png)

éšåå®šä½shellcodeï¼Œshellcodeä½¿ç”¨RC4ç®—æ³•è¿›è¡Œäº†åŠ å¯†ï¼Œå¯†é’¥ä¸º3jB(2bsG#@c7ã€‚

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398276180.8267226566762275.png)

å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œshellcodeç”±8å­—èŠ‚\\xFE\\xED\\xFA\\xCE\\xFE\\xED\\xFA\\xCEå®šä½ï¼Œåç»­0x43B08å­—èŠ‚ä¸ºå…¶shellcodeã€‚

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398276940.18594858305256534.png)

ç„¶åè·³è½¬åˆ°shellcodeæ‰§è¡Œã€‚

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398277670.059401506112144786.png)

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398278350.681507534743866.png)

æ­¤æ—¶0x000001C7B90D3FA0ä¸ºshellcodeåœ°å€ã€‚

éšåä½¿ç”¨åå°„dllæ³¨å…¥æŠ€æœ¯åŠ è½½äº†æ”¾åœ¨shellcodeä¸­çš„dllæ–‡ä»¶ï¼Œè¿™é‡Œè·å–äº†ä¸€äº›dllå‡½æ•°ç”¨æ¥åç»­ä¿®å¤å¯¼å…¥è¡¨ã€‚

shellcodeåç§»0x65Då¤„ä¸ºdllæ–‡ä»¶å¼€å§‹å¤„ã€‚

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398279110.20612699795905587.png)

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398279880.5481504308411423.png)

å¯¹è¯¥dllè¿›è¡Œåˆ†æï¼Œå‘ç°å…¶è¡Œä¸ºå¦‚ä¸‹ï¼š

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398280630.6715046257901156.png)

å¦‚æœé¦–æ¬¡æ‰§è¡Œï¼Œå†™å…¥manifestå½“å‰æ—¶é—´ï¼Œåç»­æ‰§è¡Œåˆ¤æ–­æ˜¯å¦è¿‡äº†604800sï¼ˆä¸ƒå¤©ï¼‰ï¼Œå¦‚æœå·²ç»è¿‡äº†ä¸ƒå¤©åˆ™å‘https://raw.githubusercontent.com/IconStorages/images/main/icon%d.icoå‘é€è¯·æ±‚ï¼ŒåŠ è½½åç»­çš„payloadã€‚

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398281330.01286854082608846.png)

ä¸ƒå¤©æ­£å¥½ä¸3æœˆ22å·çš„é¦–æ¬¡æ›´æ–°è‡³3æœˆ29æ—¥é¦–æ¬¡ç¡®å®šæ”»å‡»è¡Œä¸ºçš„é—´éš”ä¸€æ ·ã€‚

åœ¨æœ¬æ–‡ç« æ‰€å†™çš„2023å¹´5æœˆ9æ—¥ï¼Œç”±äºå…¶Githubä»“åº“å·²å…³é—­ï¼Œæ— æ³•è·å–åç»­payloadã€‚ä½†æ˜¯é€šè¿‡é™æ€åˆ†æå¯ä»¥å¾—å‡ºï¼Œåç»­ä¼šä½¿ç”¨AES-GCMç®—æ³•è¿›è¡Œè§£å¯†ä»iconä¸­è·å–çš„æ•°æ®ã€‚è§£å¯†ç»“æœä¸ºC2æœåŠ¡å™¨åŸŸåï¼ŒåŸŸåå¦‚ä¸‹ï¼š

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398282080.37242853268217735.png)

## å››ã€ç›¸å…³ååº”

2023å¹´3æœˆ30æ—¥ï¼Œ3CXDesktopAppçš„æä¾›å•†åœ¨å®˜ç½‘ä¸Šå‘å‡ºå®‰å…¨è­¦å‘Šã€‚

2023å¹´3æœˆ31æ—¥ï¼Œffmpegå£°æ˜ï¼Œå…¶åªæä¾›æºä»£ç ï¼Œç¼–è¯‘çš„â€ffmpeg.dllâ€œç”±ä¾›åº”å•†æä¾›ã€‚

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398282820.8297255674640999.png)

2023å¹´4æœˆ6æ—¥ï¼Œ3CXå‘å¸ƒæœªè¢«æ”»å‡»çš„18.12.425ç‰ˆæœ¬è½¯ä»¶ã€‚

## äº”ã€äº‹ä»¶å¯ç¤º

æœ¬æ¬¡äº‹ä»¶ï¼Œç¡®å®šæ˜¯ä¸€èµ·ä¾›åº”é“¾æ”»å‡»äº‹ä»¶ï¼Œæ”»å‡»è€…ä»¥3CXå…¬å¸ä½œä¸ºæ”»å‡»å¯¹è±¡ã€‚

æœ€åˆçš„æ”»å‡»å®šä½åœ¨2022å¹´4æœˆï¼Œä¸€åå‘˜å·¥åœ¨å…¶ä¸ªäººè®¡ç®—æœºä¸Šå®‰è£…äº†å—æ„ŸæŸ“çš„X\_TRADERè½¯ä»¶ï¼Œè¯¥è½¯ä»¶äº2020å¹´åœç”¨ï¼Œä½†å…¶è½¯ä»¶ç­¾åæœ‰æ•ˆæœŸæŒç»­åˆ°äº†2022å¹´10æœˆã€‚

éšåæ”»å‡»è€…é€šè¿‡è¯¥æ¶æ„è½¯ä»¶è·å–äº†ç®¡ç†å‘˜çº§åˆ«çš„æƒé™å¹¶ä¸”ä½¿ç”¨frpå·¥å…·åœ¨3CXç½‘ç»œä¸­æ¨ªå‘ç§»åŠ¨ï¼Œæœ€ç»ˆç ´åäº†Windowså’ŒmacOSçš„æ„å»ºç¯å¢ƒã€‚

å…·ä½“çš„ç ´åæ‰‹æ³•æ²¡æœ‰å…¬å¸ƒï¼Œæ®ç¬”è€…çŒœæµ‹ï¼Œå¯èƒ½æ˜¯ç±»ä¼¼SolarWindsäº‹ä»¶(è¢«æ”»å‡»è€…ç ´åäº†äº§å“çš„æ„å»ºç³»ç»Ÿ)ï¼Œä¹Ÿå¯èƒ½æ˜¯ç¯¡æ”¹äº†æ„å»ºçš„åŸºç¡€æºç ã€‚

ä¸¤æ¬¡æ”»å‡»çš„è¿‡ç¨‹æä¸ºç±»ä¼¼ï¼Œéƒ½æ˜¯ä½¿ç”¨å·²ç­¾åçš„å®‰è£…åŒ…å®‰è£…äº†è½¯ä»¶ï¼Œå®‰è£…è¿‡ç¨‹é‡Šæ”¾äº†æ¶æ„æ–‡ä»¶ï¼Œæœ€åé€šè¿‡åå°„dllæ³¨å…¥ï¼Œå¤–è”C2æœåŠ¡å™¨ã€‚3CXçš„æ”»å‡»è¿‡ç¨‹å¦‚ä¸‹å›¾ï¼š

![](./3cx-desktop-app-supply-chain-attack-analysis/assets/17617398283570.44323670597836884.jpeg)

åœ¨3æœˆ22æ—¥3CXesktopAppé¦–æ¬¡è¢«æ€æ¯’è½¯ä»¶å‘Šè­¦çš„æ—¶å€™ï¼Œéƒ¨åˆ†ç”¨æˆ·è®¤ä¸ºæ˜¯æ€æ¯’è½¯ä»¶çš„è¯¯æŠ¥ï¼Œå¯ä»¥çœ‹å‡ºç”±äºåº”ç”¨æ›´æ–°çš„æ—¶å€™å·²ç»ç»è¿‡äº†ç­¾åå’Œè®¤è¯ï¼Œæ‰€ä»¥ç”¨æˆ·å¯¹è¯¥åº”ç”¨ä¿æŒäº†ä¸€å®šçš„ä¿¡ä»»ï¼Œç„¶è€Œè¿™ç§ä¿¡ä»»ä¼šå¯¼è‡´ä¾›åº”é“¾ä¸Šæ¸¸ç¯èŠ‚çš„å®‰å…¨é—®é¢˜åœ¨ä¸‹æ¸¸ç¯èŠ‚è¢«æ”¾å¤§ã€‚å¹¶ä¸”åœ¨æ›´ä¸Šæ¸¸ï¼Œä»3CXå‘˜å·¥å› ä¸ºä¸‹è½½X\_TRADERè½¯ä»¶å¯¼è‡´æ„å»ºç¯å¢ƒè¢«ç ´åå¯ä»¥çœ‹å‡ºï¼Œäº’è”ç½‘ä»ä¸šè€…ä¸æ™®é€šç”¨æˆ·å¯¹å¸¦æœ‰åˆæ³•ç­¾åçš„è½¯ä»¶å‡æ— é˜²èŒƒã€‚

å› æ­¤ï¼Œä¾›åº”é“¾å®‰å…¨çš„ä¿è¯ä¸ä»…åœ¨äºä¾›åº”å•†å¯¹å®‰å…¨çš„é‡è§†ï¼Œå®¢æˆ·ä¹Ÿåº”åŠ å¼ºå¯¹ä¾›åº”é“¾å®‰å…¨çš„é‡è§†ï¼Œå®šæœŸå¯¹å…¶ä½¿ç”¨çš„ç»„ä»¶ã€è½¯ä»¶ç­‰è¿›è¡Œå®‰å…¨æ£€æµ‹ã€‚